#!/bin/bash

# Check if the "targets.txt" file exists
if [ ! -f "targets.txt" ]; then
    echo "File 'targets.txt' not found."
    exit 1
fi

# Create an output file to store the results
output_file="whois_results.txt"
touch "$output_file"

# Loop through each line in "targets.txt"
while IFS= read -r ip_address; do
    # Run the whois command and store the result in a variable
    whois_result=$(whois "$ip_address")

    # Extract "netname" and "descr" from the whois result
    netname=$(echo "$whois_result" | grep -i "netname:" | sed -e 's/^[[:space:]]*//')
    descr=$(echo "$whois_result" | grep -i "descr:" | sed -e 's/^[[:space:]]*//')
    inetnum=$(echo "$whois_result" | grep -i "inetnum:" | sed -e 's/^[[:space:]]*//')

    # Write the results to the output file
    echo "$ip_address" >> "$output_file"
    echo "$netname" >> "$output_file"
    echo "$descr" >> "$output_file"
    echo "$inetnum" >> "$output_file"
    echo "-------------------------" >> "$output_file"

done < "targets.txt"

echo "Results written to $output_file"
