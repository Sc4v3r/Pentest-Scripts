#! /bin/sh

# Requires:
# - your favorite "sort by IP" script/alias as ipsort
# - xpath evaluator script/alias as xp

xmlfile=$1

echo "SSL hosts"
cat ${xmlfile} | xp '/document/ssltest[protocol[contains(@type, "ssl") and @enabled="1"]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo

echo "TLSv1.0 hosts"
cat ${xmlfile} | xp '/document/ssltest[protocol[contains(@type, "tls") and @version="1.0" and @enabled="1"]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo

echo "DES hosts"
cat ${xmlfile} | xp '/document/ssltest[cipher[contains(@cipher, "DES")]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo

echo "RC4 hosts"
cat ${xmlfile} | xp '/document/ssltest[cipher[contains(@cipher, "RC4")]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo


echo "MD5 hosts"
cat ${xmlfile} | xp '/document/ssltest[cipher[contains(@cipher, "MD5")]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo


echo "Low Bits"
cat ${xmlfile} | xp '/document/ssltest[cipher[number(@bits) < 128]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo


echo "Low DHE Bits"
cat ${xmlfile} | xp '/document/ssltest[cipher[number(@dhebits) < 1024]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo

echo "All hosts with TLS/SSL Problems"
cat .sslscan-tmp.txt | ipsort | uniq
rm .sslscan-tmp.txt
#! /bin/sh

# Requires:
# - your favorite "sort by IP" script/alias as ipsort
# - xpath evaluator script/alias as xp

xmlfile=$1

echo "SSL hosts"
cat ${xmlfile} | xp '/document/ssltest[protocol[contains(@type, "ssl") and @enabled="1"]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo

echo "TLSv1.0 hosts"
cat ${xmlfile} | xp '/document/ssltest[protocol[contains(@type, "tls") and @version="1.0" and @enabled="1"]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo

echo "DES hosts"
cat ${xmlfile} | xp '/document/ssltest[cipher[contains(@cipher, "DES")]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo

echo "RC4 hosts"
cat ${xmlfile} | xp '/document/ssltest[cipher[contains(@cipher, "RC4")]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo


echo "MD5 hosts"
cat ${xmlfile} | xp '/document/ssltest[cipher[contains(@cipher, "MD5")]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo


echo "Low Bits"
cat ${xmlfile} | xp '/document/ssltest[cipher[number(@bits) < 128]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo


echo "Low DHE Bits"
cat ${xmlfile} | xp '/document/ssltest[cipher[number(@dhebits) < 1024]]/@host' | ipsort | uniq | tee -a .sslscan-tmp.txt
echo

echo "All hosts with TLS/SSL Problems"
cat .sslscan-tmp.txt | ipsort | uniq
rm .sslscan-tmp.txt
